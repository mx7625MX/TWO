# 钱包管理功能测试指南

## 快速开始

### 运行快速测试（推荐）

```bash
npm test
```

这将运行不依赖网络的本地测试，包括：
- 创建BSC和Solana钱包
- 私钥加密解密
- 导入钱包（私钥和助记词）
- 地址验证
- 余额格式化

### 运行完整测试

```bash
npm run test:full
```

完整测试包括网络相关功能，需要：
- 稳定的网络连接
- BSC RPC节点可访问
- Solana RPC节点可访问

## 测试文件

### 1. 快速测试 (`src/tests/quick-test.ts`)

**特点**:
- ✅ 无网络依赖
- ✅ 快速执行（<5秒）
- ✅ 测试核心功能
- ✅ 适合CI/CD

**测试内容**:
- 创建BSC钱包
- 创建Solana钱包
- 私钥加密/解密
- WalletManager加密集成
- 导入BSC私钥
- 导入Solana私钥
- 导入助记词
- 密码强度验证
- 地址验证
- 余额格式化

### 2. 完整测试 (`src/tests/wallet-manager.test.ts`)

**特点**:
- ⚠️ 需要网络连接
- ⏱️ 执行时间较长（30-60秒）
- ✅ 测试所有功能
- ✅ 包括余额查询

**附加测试内容**:
- BSC余额查询（真实网络）
- Solana余额查询（真实网络）
- WalletManager余额查询
- 批量余额查询
- 错误处理

## 测试结果

### 最新测试结果

```
🧪 开始钱包管理快速测试

测试1: 创建BSC钱包                    ✅ 通过
测试2: 创建Solana钱包                 ✅ 通过
测试3: 私钥加密和解密                 ✅ 通过
测试4: WalletManager加密解密          ✅ 通过
测试5: 导入BSC私钥                    ✅ 通过
测试6: 导入Solana私钥                 ✅ 通过
测试7: 导入助记词                     ✅ 通过
测试8: 密码强度验证                   ✅ 通过
测试9: 地址验证                       ✅ 通过
测试10: 余额格式化                    ✅ 通过

==================================================
📊 测试结果
==================================================
总计: 10
通过: 10 ✅
失败: 0 ❌
成功率: 100.00%
==================================================
🎉 所有本地测试通过！
```

## 手动测试

某些功能需要在运行的应用中手动测试：

### 1. 余额查询测试

**步骤**:
1. 运行应用: `npm run electron:dev`
2. 创建或导入钱包
3. 点击"查询余额"按钮
4. 验证余额显示

**验证点**:
- [ ] 网络请求成功
- [ ] 余额数值正确
- [ ] 货币符号正确（BNB/SOL）
- [ ] 错误提示清晰

### 2. 批量查询测试

**步骤**:
1. 确保有多个钱包（至少3个）
2. 点击"批量查询余额"按钮
3. 观察查询过程
4. 验证统计卡片更新

**验证点**:
- [ ] 查询进度反馈
- [ ] 所有钱包都被查询
- [ ] 统计卡片数据正确
- [ ] 失败钱包有提示

### 3. UI/UX测试

**测试项目**:
- [ ] 创建钱包流程顺畅
- [ ] 导入钱包表单验证有效
- [ ] 私钥/助记词显示一次后不可再见
- [ ] 删除钱包需要确认
- [ ] 响应式布局正常
- [ ] 加载状态清晰
- [ ] 错误提示友好

### 4. 数据持久化测试

**步骤**:
1. 创建多个钱包
2. 关闭应用
3. 重新打开应用
4. 验证数据保留

**验证点**:
- [ ] 钱包列表完整
- [ ] 钱包信息正确
- [ ] 余额数据保留（如有）
- [ ] 数据库文件存在

## 常见问题

### Q: 测试失败怎么办？

A: 
1. 检查Node.js版本（建议16+）
2. 清理并重新安装依赖: `rm -rf node_modules && npm install`
3. 查看具体错误信息
4. 检查是否有语法错误

### Q: 网络测试超时？

A:
1. 检查网络连接
2. 尝试更换RPC节点
3. 增加超时时间
4. 使用VPN（如果RPC被限制）

### Q: 余额查询返回0？

A:
1. 确认地址正确
2. 使用区块链浏览器验证
3. 检查RPC节点状态
4. 查看控制台错误日志

### Q: 导入助记词失败？

A:
1. 确认助记词正确（12/24个单词）
2. 检查单词拼写
3. 确认单词用空格分隔
4. 尝试使用已知有效的测试助记词

## 测试覆盖率

### 已测试功能

- ✅ 钱包创建（BSC/Solana）
- ✅ 私钥加密/解密
- ✅ 钱包导入（私钥/助记词）
- ✅ 地址验证
- ✅ 余额格式化
- ✅ 密码强度验证
- ✅ WalletManager API
- ⏳ 余额查询（需手动测试）
- ⏳ UI交互（需手动测试）

### 未测试功能

以下功能尚未实现或测试：

- ⬜ 代币余额查询
- ⬜ 交易发送
- ⬜ 交易历史
- ⬜ 价格转换
- ⬜ 多语言支持

## 贡献测试

如果你想添加新的测试：

1. 在 `src/tests/` 目录创建测试文件
2. 导入需要测试的模块
3. 编写测试用例
4. 运行测试验证
5. 更新本文档

## 相关文档

- [测试报告](./TEST_REPORT.md) - 详细的测试结果和分析
- [加密工具文档](./CRYPTO_UTILS.md) - 加密功能说明
- [项目README](../README.md) - 项目总体说明

## 联系支持

如果遇到测试问题：
1. 查看测试报告中的常见问题
2. 检查控制台输出的详细错误
3. 创建Issue描述问题
4. 提供测试环境信息

---

**最后更新**: 2026-01-17  
**测试版本**: v1.0.0  
**状态**: ✅ 所有核心功能测试通过
